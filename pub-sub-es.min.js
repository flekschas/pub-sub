!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.createPubSub={})}(this,function(e){"use strict";var n,t=(n=window.BroadcastChannel)?new n("pub-sub-es"):(console.warn("The Broadcast Channel API is not available in your browser."),{postMessage:function(){}}),s=function(e){return function(n,t,s){return void 0===s&&(s=1/0),e[n]||(e[n]=[],e.__times__[n]=[]),e[n].push(t),e.__times__[n].push(+s||1/0),{event:n,handler:t}}},i=function(e){return function(n,t){if(e[n]){"object"==typeof n&&(t=(n=n.event).handler);var s=e[n].indexOf(t);e[n]&&(-1===s||s>=e[n].length||(e[n].splice(s,1),e.__times__[n].splice(s,1)))}}},o=function(e,n){return function(s,o,u){if(e[s]){var r=i(e);if(e[s].forEach(function(n,t){n(o),e.__times__[s][t]--,e.__times__[s][t]<1&&r(s,n)}),n&&!u)try{t.postMessage({event:s,news:o})}catch(e){if(!(e instanceof DOMException))throw e;console.warn('Could not broadcast "'+s+'" globally. Payload is not clonable.')}}}},u=function(e){return void 0===e&&(e={__times__:{}}),e.__times__||(e.__times__={}),{publish:o(e),subscribe:s(e),unsubscribe:i(e),stack:e}},r={__times__:{}},a={publish:o(r,!0),subscribe:s(r),unsubscribe:i(r),stack:r};t.onmessage=function(e){var n=e.data,t=n.event,s=n.news;return a.publish(t,s,!0)},e.globalPubSub=a,e.createPubSub=u,e.default=u,Object.defineProperty(e,"__esModule",{value:!0})});
